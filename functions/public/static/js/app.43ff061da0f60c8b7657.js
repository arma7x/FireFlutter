webpackJsonp([8],{104:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(57),i=n(409),o=n(187),s=n(186);r.default.use(i.a);var a=new i.a.Store({modules:{user:o.a,shared:s.a}})},153:function(e,t){e.exports={firebase:{apiKey:"AIzaSyDqnMO3jiIVhs8hRj7SInrcIb0yYP_UOWo",authDomain:"fireflutter-f1304.firebaseapp.com",databaseURL:"https://fireflutter-f1304.firebaseio.com",projectId:"fireflutter-f1304",storageBucket:"fireflutter-f1304.appspot.com",messagingSenderId:"436808076830",appId:"1:436808076830:web:203de1b486bf426d"},firebaseMessagingPublicVapidKey:"BJsIg3YzlzWtHZRRAJZtszJycz8t8M5sxtTMNUgs86Dhv-3u-Y5lCnLehbhnBIoE6JFv5MeDVjxB6pZlDsGv90Q"}},154:function(e,t,n){"use strict";var r=n(57),i=n(408),o=n(185),s=function(){return n.e(6).then(n.bind(null,410))},a=function(){return n.e(4).then(n.bind(null,411))},u=function(){return n.e(1).then(n.bind(null,414))},c=function(){return n.e(2).then(n.bind(null,413))},d=function(){return n.e(3).then(n.bind(null,412))};r.default.use(i.a),t.a=new i.a({routes:[{path:"/",name:"Home",component:s},{path:"/profile",name:"Profile",component:a,beforeEnter:o.a},{path:"/signup",name:"Signup",component:u,beforeEnter:o.b},{path:"/signin",name:"Signin",component:c,beforeEnter:o.b},{path:"/reset-password",name:"Reset Password",component:d,beforeEnter:o.b}],mode:"history"})},155:function(e,t,n){"use strict";function r(e){for(var t="",n="_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*r));return t}t.a=r},184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(156),i=(n.n(r),n(57)),o=n(157),s=n.n(o),a=n(74),u=(n.n(a),n(154)),c=n(104),d=n(153),l=n.n(d),m=n(155),f=function(){return n.e(0).then(n.bind(null,406))},h=function(){return n.e(5).then(n.bind(null,407))};i.default.use(s.a),i.default.config.productionTip=!1,u.a.beforeEach(function(e,t,n){document.title="FireFlutter | "+e.name,n()}),i.default.component("app-alert",h),new i.default({el:"#app",router:u.a,store:c.a,template:"<App/>",components:{App:f},created:function(){var e=this;null===localStorage.getItem("client_id")&&localStorage.setItem("client_id",n.i(m.a)(20)),this.$store.dispatch("setClientId",localStorage.getItem("client_id")),a.initializeApp(l.a.firebase),a.auth().onAuthStateChanged(function(t){t&&a.auth().currentUser.getIdTokenResult().then(function(t){var n={uid:t.claims.user_id,name:t.claims.name||"Unknown",email:t.claims.email,photoUrl:t.claims.picture,admin:t.claims.admin||!1};e.$store.dispatch("autoSignIn",n)})}),a.database().ref(".info/connected").on("value",function(t){if(!0===t.val()&&null!==e.$store.getters.user&&void 0!==e.$store.getters.user){var n=a.database().ref("/users/"+e.$store.getters.user.uid+"/online");n.onDisconnect().set(!1),n.set(!0)}});var t=a.messaging();t.usePublicVapidKey(l.a.firebaseMessagingPublicVapidKey),Notification.requestPermission().then(function(e){return t.getToken()}).then(function(t){e.$store.dispatch("setFcm",t),null!==e.$store.getters.user&&void 0!==e.$store.getters.user&&e.$store.dispatch("addActiveDevice",{uid:e.$store.getters.user.id})}).catch(function(e){}),t.onTokenRefresh(function(){t.getToken().then(function(t){e.$store.dispatch("setFcm",t),null!==e.$store.getters.user&&void 0!==e.$store.getters.user&&e.$store.dispatch("addActiveDevice",{uid:e.$store.getters.user.id})}).catch(function(e){})})}})},185:function(e,t,n){"use strict";function r(e,t,n){o.a.getters.user?n():n("/signin")}function i(e,t,n){o.a.getters.user?n("/"):n()}t.a=r,t.b=i;var o=n(104)},186:function(e,t,n){"use strict";var r=n(189),i=n.n(r),o=n(74);n.n(o);t.a={state:{client_id:"",fcm:"",loading:!1,error:null},mutations:{setClientId:function(e,t){e.client_id=t},setFcm:function(e,t){e.fcm=t},setLoading:function(e,t){e.loading=t},setError:function(e,t){e.error=t},clearError:function(e){e.error=null}},actions:{setClientId:function(e,t){(0,e.commit)("setClientId",t)},setFcm:function(e,t){(0,e.commit)("setFcm",t)},clearError:function(e){(0,e.commit)("clearError")},setError:function(e,t){(0,e.commit)("setError",t)},addActiveDevice:function(e,t){var n=(e.commit,e.state),r={client:window.navigator.userAgent,datetime:(new Date).getTime(),fcm:n.fcm};o.database().ref("/users/"+t.uid+"/devices").set(i()({},n.client_id,r)),o.database().ref("/users/"+t.uid+"/online").set(!0)},removeActiveDevice:function(e,t){var n=(e.commit,e.state);o.database().ref("/users/"+t.uid+"/devices").child(n.client_id).remove(),o.database().ref("/users/"+t.uid+"/online").set(!1)}},getters:{client_id:function(e){return e.client_id},fcm:function(e){return e.fcm},loading:function(e){return e.loading},error:function(e){return e.error}}}},187:function(e,t,n){"use strict";var r=n(74),i=(n.n(r),n(167)),o=n.n(i);t.a={state:{user:null},mutations:{setUser:function(e,t){e.user=t}},actions:{updateUserProfile:function(e,t){var n=e.commit;e.state;n("setLoading",!0),n("clearError");var i=r.auth().currentUser;i.updateProfile(t).then(function(){n("setLoading",!1),n("clearError");var e={uid:i.uid,name:i.displayName,email:i.email,photoUrl:i.photoURL};n("setUser",e)}).catch(function(e){n("setLoading",!1),n("setError",e)})},selfDestructAccount:function(e,t){var n=e.commit;e.dispatch,e.state;n("setLoading",!0),r.auth().currentUser.getIdToken(!0).then(function(e){return o.a.get("https://us-central1-"+r.apps[0].options.projectId+".cloudfunctions.net/selfDestructAccount",{params:{token:e}})}).then(function(e){n("setLoading",!1),n("clearError"),r.auth().signOut(),n("setUser",null)}).catch(function(e){n("setLoading",!1),n("setError",e)})},signUserUp:function(e,t){var n=e.commit,i=e.dispatch,o=e.state;n("setLoading",!0),n("clearError"),r.auth().createUserWithEmailAndPassword(t.email,t.password).then(function(e){n("setLoading",!1);var t={uid:e.user.uid,name:e.user.displayName,email:e.user.email,photoUrl:e.user.photoURL};n("setUser",t),i("addActiveDevice",{uid:o.user.uid})}).catch(function(e){n("setLoading",!1),n("setError",e)})},signUserIn:function(e,t){var n=e.commit,i=e.dispatch,o=e.state;n("setLoading",!0),n("clearError"),r.auth().signInWithEmailAndPassword(t.email,t.password).then(function(e){n("setLoading",!1);var t={uid:e.user.uid,name:e.user.displayName,email:e.user.email,photoUrl:e.user.photoURL};n("setUser",t),i("signUserInCustomToken"),i("addActiveDevice",{uid:o.user.uid})}).catch(function(e){n("setLoading",!1),n("setError",e)})},signUserInGoogle:function(e){var t=e.commit,n=e.dispatch,i=e.state;t("setLoading",!0),t("clearError"),r.auth().signInWithPopup(new r.auth.GoogleAuthProvider).then(function(e){t("setLoading",!1);var r={uid:e.user.uid,name:e.user.displayName,email:e.user.email,photoUrl:e.user.photoURL};t("setUser",r),n("signUserInCustomToken"),n("addActiveDevice",{uid:i.user.uid})}).catch(function(e){t("setLoading",!1),t("setError",e)})},signUserInFacebook:function(e){var t=e.commit;t("setLoading",!0),t("clearError"),r.auth().signInWithPopup(new r.auth.FacebookAuthProvider).then(function(e){t("setLoading",!1);var n={uid:e.user.uid,name:e.user.displayName,email:e.user.email,photoUrl:e.user.photoURL};t("setUser",n)}).catch(function(e){t("setLoading",!1),t("setError",e)})},signUserInGithub:function(e){var t=e.commit;t("setLoading",!0),t("clearError"),r.auth().signInWithPopup(new r.auth.GithubAuthProvider).then(function(e){t("setLoading",!1);var n={uid:e.user.uid,name:e.user.displayName,email:e.user.email,photoUrl:e.user.photoURL};t("setUser",n)}).catch(function(e){t("setLoading",!1),t("setError",e)})},signUserInTwitter:function(e){var t=e.commit;t("setLoading",!0),t("clearError"),r.auth().signInWithPopup(new r.auth.TwitterAuthProvider).then(function(e){t("setLoading",!1);var n={uid:e.user.uid,name:e.user.displayName,email:e.user.email,photoUrl:e.user.photoURL};t("setUser",n)}).catch(function(e){t("setLoading",!1),t("setError",e)})},signUserInCustomToken:function(e){var t=e.commit;t("setLoading",!0),t("clearError"),r.auth().currentUser.getIdToken(!0).then(function(e){return o.a.get("https://us-central1-"+r.apps[0].options.projectId+".cloudfunctions.net/verifyAdmin",{params:{token:e}})}).then(function(e){return r.auth().signInWithCustomToken(e.data.token)}).then(function(e){t("setLoading",!1),location.reload()}).catch(function(){t("setLoading",!1)})},autoSignIn:function(e,t){(0,e.commit)("setUser",{uid:t.uid,name:t.name,email:t.email,photoUrl:t.photoUrl,admin:t.admin||!1})},resetPasswordWithEmail:function(e,t){var n=e.commit,i=t.email;n("setLoading",!0),r.auth().sendPasswordResetEmail(i).then(function(){n("setLoading",!1)}).catch(function(e){n("setLoading",!1),n("setError",e)})},logout:function(e){var t=e.commit;(0,e.dispatch)("removeActiveDevice",{uid:e.state.user.uid}),r.auth().signOut(),t("setUser",null)}},getters:{user:function(e){return e.user}}}}},[184]);