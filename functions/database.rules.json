{
  /* Visit https://firebase.google.com/docs/database/security to learn more about security rules. */
  "rules": {
    "chats": {
      "$uid": {
        ".read": "$uid === auth.uid || auth.token.admin == true",
        "$any": {
          ".write": false
        },
        "topic": {
          ".write": "auth.token.admin == true"
        },
        "timestamp": {
          ".write": false
        },
        "status": {
          ".write": "auth.token.admin == true"
        },
        "assigned_user": {
          ".write": "auth.token.admin == true"
        },
        "logs": {
          "$log_id": {
            ".validate": "(root.child('chats').child($uid).exists() && (newData.child('user').val() == auth.uid || auth.token.admin == true) && (newData.child('timestamp').val() == now) && (newData.child('message').child('mime').exists() && newData.child('message').child('data').exists() && newData.child('message').child('caption').exists())) || auth.token.admin == true",
            ".write": "(root.child('chats').child(auth.uid).exists() && !data.exists() && auth.uid == $uid) || auth.token.admin == true"
          }
        }
      }
    },
    "queues": {
      ".read": "auth.token.admin == true",
      ".write": "auth.token.admin == true"
    },
    "users": {
      "$uid": {
        ".read": "$uid === auth.uid",
        "$any": {
          ".write": false
        },
        "devices": {
          ".write": "$uid === auth.uid"
        },
        "online": {
          ".write": "$uid === auth.uid"
        },
        "role": {
          ".write": false
        }
      }
    },
    "users_public": {
      ".read": "auth != null",
      "$uid": {
        ".write": "auth.uid == $uid"
      }
    }
  }
}
