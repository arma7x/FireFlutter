webpackJsonp([6],{411:function(t,e,s){var i=s(417)(s(434),s(467),null,null,null);t.exports=i.exports},417:function(t,e){t.exports=function(t,e,s,i,r){var a,l=t=t||{},o=typeof t.default;"object"!==o&&"function"!==o||(a=t,l=t.default);var n="function"==typeof l?l.options:l;e&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns),i&&(n._scopeId=i);var u;if(r?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},n._ssrRegister=u):s&&(u=s),u){var c=n.functional,d=c?n.render:n.beforeCreate;c?n.render=function(t,e){return u.call(e),d(t,e)}:n.beforeCreate=d?[].concat(d,u):[u]}return{esModule:a,exports:l,options:n}}},434:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(58),r=(s.n(i),s(163)),a=s.n(r);e.default={data:function(){return{autoGrow:!1,autofocus:!0,clearable:!1,counter:!0,filled:!1,flat:!1,hint:"",label:"",loading:!1,noResize:!1,outlined:!1,persistentHint:!1,placeholder:"",rounded:!1,rowHeight:24,rows:2,shaped:!1,singleLine:!1,solo:!1,item:"chat",topic:null,message:null,chat:null,uid:null,assigned_user:null,queue_user:null,queue_user_private:null,hidden:!1}},computed:{user:function(){return this.$store.getters.user},metadata:function(){return this.$store.getters.metadata},error:function(){return this.$store.getters.error}},mounted:function(){var t=this,e=i.database(),s=this.$route.query.id?this.$route.query.id:this.$store.getters.user.uid;this.uid=s,null==this.queue_user&&e.ref("users_public/"+this.uid).once("value",function(e){t.queue_user=e.val()}),e.ref("users/"+this.uid).once("value",function(e){t.queue_user_private=e.val()}),e.ref("chats/"+this.uid).on("value",function(s){s.val()?(t.chat=s.val(),s.val().assigned_user&&null==t.assigned_user&&e.ref("users_public/"+s.val().assigned_user).once("value",function(e){t.assigned_user=e.val()})):t.chat=null})},updated:function(){this.$refs.chat_scroller&&(this.$refs.chat_scroller.scrollTop=this.$refs.chat_scroller.scrollHeight)},methods:{toggleHidden:function(){this.hidden=!this.hidden},joinQueue:function(){var t=this;confirm("Are sure to enter chat queue list ?")&&(this.$store.commit("setLoading",!0),this.$store.commit("clearError"),i.auth().currentUser.getIdToken(!0).then(function(e){return a.a.get("https://us-central1-"+i.apps[0].options.projectId+".cloudfunctions.net/joinQueue",{params:{token:e,topic:t.topic}})}).then(function(e){t.$store.commit("setLoading",!1)}).catch(function(e){t.$store.commit("setLoading",!1),t.$store.commit("setError",e.response.data)}))},sendMessage:function(){var t=this;this.$store.commit("clearError");var e={user:this.$store.getters.user.uid,timestamp:i.database.ServerValue.TIMESTAMP,message:{mime:"text",data:this.message,caption:""}};i.database().ref("/chats/"+this.uid+"/logs").push(e).then(function(){t.message=null,t.$store.commit("clearError")}).catch(function(e){t.$store.commit("setError",e)})},adminToggleStatus:function(){var t={status:0===this.chat.status?1:0};i.database().ref("chats/"+this.uid).update(t),i.database().ref("queues/"+this.uid).update(t)},deleteQueue:function(){var t=this;confirm("Are sure to exit from chat queue list ?")&&(this.$store.commit("setLoading",!0),i.auth().currentUser.getIdToken(!0).then(function(t){return a.a.get("https://us-central1-"+i.apps[0].options.projectId+".cloudfunctions.net/deleteQueue",{params:{token:t}})}).then(function(e){t.$store.commit("setLoading",!1),t.$store.commit("clearError"),t.hidden=!1}).catch(function(e){t.$store.commit("setLoading",!1),t.$store.commit("setError",e.response.data)}))},adminDeleteQueue:function(){var t=this;confirm("Are sure to delete this chat from queue list ?")&&(this.$store.commit("setLoading",!0),i.auth().currentUser.getIdToken(!0).then(function(e){return a.a.get("https://us-central1-"+i.apps[0].options.projectId+".cloudfunctions.net/adminDeleteQueue",{params:{token:e,queue:t.uid}})}).then(function(e){t.$store.commit("setLoading",!1),t.$store.commit("clearError"),t.hidden=!1,t.$router.go(-1)}).catch(function(e){t.$store.commit("setLoading",!1),t.$store.commit("setError",e.response.data)}))}}}},467:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{staticClass:"center-vertical"},[s("v-layout",{attrs:{column:""}},[null==t.chat?s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[s("v-card",{staticClass:"mb-2"},[s("v-card-text",[s("form",{staticStyle:{width:"100%"},on:{submit:function(e){return e.preventDefault(),t.joinQueue(e)}}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{name:"topic",label:"Topic of discussion or issue ?",id:"topic",type:"text",required:""},model:{value:t.topic,callback:function(e){t.topic=e},expression:"topic"}}),t._v(" "),s("v-btn",{staticClass:"primary",attrs:{block:""},on:{click:t.joinQueue}},[t._v("Join Queue")])],1)],1)],1)])],1)],1)],1):t._e(),t._v(" "),null!=t.chat?s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[null!=t.chat?s("div",[s("v-container",{ref:"chat_scroller",staticClass:"mx-0 my-0 px-0 py-0 scroll-y",staticStyle:{height:"68vh"}},[void 0!=t.chat.logs?s("v-layout",{staticClass:"mx-0 px-0",attrs:{column:""}},[s("ul",{staticStyle:{"list-style":"none"}},t._l(t.chat.logs,function(e,i){return s("li",{key:i},[s("v-layout",{staticClass:"mb-2 px-0",attrs:{row:""}},[e.user!=t.user.uid&&e.user==t.chat.assigned_user?s("v-list-tile-avatar",{attrs:{color:"grey",size:"40"}},[null!=t.assigned_user.photoUrl?s("img",{attrs:{src:t.assigned_user.photoUrl}}):t._e(),t._v(" "),null==t.assigned_user.photoUrl?s("v-icon",{attrs:{size:"50",color:"white"}},[t._v("account_circle")]):t._e()],1):t._e(),t._v(" "),e.user!=t.user.uid&&e.user==t.uid?s("v-list-tile-avatar",{attrs:{color:"grey",size:"40"}},[null!=t.queue_user.photoUrl?s("img",{attrs:{src:t.queue_user.photoUrl}}):t._e(),t._v(" "),null==t.queue_user.photoUrl?s("v-icon",{attrs:{size:"50",color:"white"}},[t._v("account_circle")]):t._e()],1):t._e(),t._v(" "),s("v-flex",{class:{"col-auto ml-auto":e.user==t.user.uid},attrs:{xs12:"",sm6:""}},[s("v-card",[s("v-card-text",{staticClass:"mx-0 my-0"},[s("v-list-tile-content",[s("v-list-tile-sub-title",{staticClass:"black--text",staticStyle:{"white-space":"normal"},style:{textAlign:e.user==t.user.uid?"right":"left"}},[t._v(t._s(e.message.data))]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"caption grey--text",style:{textAlign:e.user==t.user.uid?"right":"left"}},[t._v(t._s(new Date(e.timestamp).toLocaleString()))])],1)],1)],1)],1),t._v(" "),e.user==t.user.uid?s("v-list-tile-avatar",{staticClass:"ml-3",attrs:{color:"grey",size:"40"}},[null!=t.user.photoUrl?s("img",{attrs:{src:t.user.photoUrl}}):t._e(),t._v(" "),null==t.user.photoUrl?s("v-icon",{attrs:{size:"50",color:"white"}},[t._v("account_circle")]):t._e()],1):t._e()],1)],1)}),0)]):t._e()],1),t._v(" "),s("form",{staticClass:"transparent",staticStyle:{width:"100%"},on:{submit:function(e){return e.preventDefault(),t.sendMessage(e)}}},[s("v-layout",{staticClass:"transparent",attrs:{row:"",wrap:"","align-center":""}},[s("v-flex",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"},attrs:{xs2:""}},[s("v-btn",{attrs:{fab:"",small:"",color:"info"},on:{click:t.toggleHidden}},[s("v-icon",{attrs:{dark:""}},[t._v("announcement")])],1)],1),t._v(" "),s("v-flex",{staticClass:"transparent",attrs:{xs8:""}},[s("v-textarea",{attrs:{"auto-grow":t.autoGrow,clearable:t.clearable,counter:!!t.counter&&t.counter,filled:t.filled,flat:t.flat,hint:t.hint,label:t.label,loading:t.loading,"no-resize":t.noResize,outlined:t.outlined,"persistent-hint":t.persistentHint,placeholder:t.placeholder,rounded:t.rounded,"row-height":t.rowHeight,rows:t.rows,shaped:t.shaped,"single-line":t.singleLine,solo:t.solo},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),t._v(" "),s("v-flex",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"},attrs:{xs2:""}},[s("v-btn",{attrs:{fab:"",small:"",color:"primary"},on:{click:t.sendMessage}},[s("v-icon",{attrs:{dark:""}},[t._v("send")])],1)],1)],1)],1)],1):t._e()])],1):t._e()],1),t._v(" "),s("v-dialog",{attrs:{"max-width":"280px"},model:{value:t.hidden,callback:function(e){t.hidden=e},expression:"hidden"}},[s("v-card",[s("v-card-text",[s("div",{staticClass:"text-xl-center text-lg-center text-sm-center text-md-center text-xs-center"},[null!=t.chat?s("div",[s("v-list",{attrs:{subheader:""}},[s("v-list-tile",[s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"title"},[t._v("Topic")]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"body-1"},[t._v(t._s(t.chat.topic))])],1)],1),t._v(" "),s("v-list-tile",{staticClass:"mt-1"},[s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2"},[t._v("Timestamp")]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"body-1"},[t._v(t._s(new Date(t.chat.timestamp).toLocaleString()))])],1)],1),t._v(" "),s("v-list-tile",{staticClass:"mt-1"},[0!=t.chat.assigned_user&&null!=t.assigned_user?s("v-list-tile-avatar",{attrs:{size:"40",color:"grey"}},[null!=t.assigned_user.photoUrl?s("img",{attrs:{src:t.assigned_user.photoUrl}}):t._e(),t._v(" "),null==t.assigned_user.photoUrl?s("v-icon",{attrs:{size:"50",color:"white"}},[t._v("account_circle")]):t._e()],1):t._e(),t._v(" "),s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2"},[t._v("Supervisor")]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"body-1"},[t._v(t._s(null!=t.assigned_user?t.assigned_user.name:"TBA"))])],1)],1),t._v(" "),s("v-list-tile",{staticClass:"mt-1"},[null!=t.queue_user?s("v-list-tile-avatar",{attrs:{size:"40",color:"grey"}},[null!=t.queue_user.photoUrl?s("img",{attrs:{src:t.queue_user.photoUrl}}):t._e(),t._v(" "),null==t.queue_user.photoUrl?s("v-icon",{attrs:{size:"50",color:"white"}},[t._v("account_circle")]):t._e()],1):t._e(),t._v(" "),s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2"},[t._v("Client")]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"body-1"},[t._v(t._s(null!=t.queue_user?t.queue_user.name:"-"))])],1)],1),t._v(" "),null!=t.queue_user_private&&1==t.metadata.role?s("v-list-tile",{staticClass:"mt-1"},[s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2"},[t._v("Client Status")]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"body-1"},[t._v(t._s(1!=t.queue_user_private.online?"Last Seen "+new Date(t.queue_user_private.last_online).toLocaleString():"Online"))])],1)],1):t._e(),t._v(" "),s("v-layout",{staticClass:"mt-1",attrs:{row:""}},[1==t.metadata.role?s("v-list-tile",[s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2 pb-2"},[t._v(t._s(0==t.chat.status?"Unlocked":"Locked"))]),t._v(" "),s("v-list-tile-sub-title",{staticClass:"body-1"},[s("v-switch",{staticClass:"my-0 mx-2",on:{change:t.adminToggleStatus},model:{value:0!=t.chat.status,callback:function(e){t.$set(t.chat,"status == 0 ? false : true",e)},expression:"chat.status == 0 ? false : true"}})],1)],1)],1):t._e(),t._v(" "),1==t.metadata.role&&0==t.chat.status?s("v-spacer"):t._e(),t._v(" "),1==t.metadata.role&&0==t.chat.status?s("v-list-tile",[s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2"},[t._v("Delete Queue")]),t._v(" "),s("v-btn",{attrs:{color:"error"},on:{click:t.adminDeleteQueue}},[t._v("\n                        Delete\n                        "),s("v-icon",{attrs:{right:""}},[t._v("delete")])],1)],1)],1):t._e(),t._v(" "),t.user.uid==t.uid&&0==t.chat.status?s("v-spacer"):t._e(),t._v(" "),t.user.uid==t.uid&&0==t.chat.status?s("v-list-tile",[s("v-list-tile-content",[s("v-list-tile-title",{staticClass:"body-2"},[t._v("Delete Queue")]),t._v(" "),s("v-btn",{attrs:{color:"error"},on:{click:t.deleteQueue}},[t._v("\n                        Delete\n                        "),s("v-icon",{attrs:{right:""}},[t._v("delete")])],1)],1)],1):t._e()],1)],1)],1):t._e()])])],1)],1)],1)},staticRenderFns:[]}}});